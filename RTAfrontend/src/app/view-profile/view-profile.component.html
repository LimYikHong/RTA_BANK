<div class="profile-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>RTA Upload</h2>
    <ul>
      <li routerLink="/batch-list" routerLinkActive="active"><b>Upload Batch File</b></li>
      <li routerLink="/incoming-batch" routerLinkActive="active"><b>Incoming Batch File</b></li>
      <li routerLink="/profile" routerLinkActive="active">View Profile</li>
      <li routerLink="/users" routerLinkActive="active"><b>User Management</b></li>
    </ul>
  </aside>

  <!-- Profile Content -->
  <button class="logout-btn" (click)="logout()">Logout</button>
  <main class="profile-content" *ngIf="profile; else loading">
    <div class="profile-header">
      <div class="avatar" (click)="openPhotoUpload()">
        <img *ngIf="profile.profilePhotoUrl" [src]="'https://localhost:8086' + profile.profilePhotoUrl"
          alt="Profile Photo" class="profile-photo" />
        <span *ngIf="!profile.profilePhotoUrl">{{
          profile.name ? profile.name.charAt(0) : '?'
          }}</span>
        <div class="edit-overlay">
          <i class="fas fa-pencil-alt"></i>
        </div>
        <input type="file" #fileInput style="display: none" (change)="onFileSelected($event)" accept="image/*" />
      </div>
      <div class="header-info">
        <h1>{{ profile.name }}</h1>
        <p class="email">{{ profile.email }}</p>
        <p class="username-display">{{'@'}}{{ profile.username }}</p>
        <button class="edit-btn" routerLink="/edit-profile">Edit Profile</button>
      </div>
    </div>

    <!-- Account Information -->
    <div class="profile-details">
      <h2>Account Information</h2>
      <div class="details-grid">
        <div class="detail-item">
          <label>Username</label>
          <span>{{ profile.username || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Email</label>
          <span>{{ profile.email || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>User ID</label>
          <span>{{ profile.merchantId || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Status</label>
          <span class="status-badge" [ngClass]="getStatusClass(profile.status)">{{ profile.status || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Two-Factor Auth</label>
          <span>{{ profile.isTwoFactorEnabled ? 'Enabled' : 'Disabled' }}</span>
        </div>
        <div class="detail-item">
          <label>Account Enabled</label>
          <span>{{ profile.isEnabled ? 'Yes' : 'No' }}</span>
        </div>
      </div>
    </div>

    <!-- Personal Information -->
    <div class="profile-details">
      <h2>Personal Information</h2>
      <div class="details-grid">
        <div class="detail-item">
          <label>Full Name</label>
          <span>{{ profile.name || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>First Name</label>
          <span>{{ profile.firstName || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Last Name</label>
          <span>{{ profile.lastName || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Phone Number</label>
          <span>{{ profile.phone || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Office Number</label>
          <span>{{ profile.officeNumber || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Contact Person</label>
          <span>{{ profile.contact || '-' }}</span>
        </div>
      </div>
    </div>

    <!-- Company Information -->
    <div class="profile-details">
      <h2>Company Information</h2>
      <div class="details-grid">
        <div class="detail-item">
          <label>Company</label>
          <span>{{ profile.company || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Address</label>
          <span>{{ profile.address || '-' }}</span>
        </div>
      </div>
    </div>

    <!-- Audit Information -->
    <div class="profile-details">
      <h2>Audit Information</h2>
      <div class="details-grid">
        <div class="detail-item">
          <label>Created At</label>
          <span>{{ profile.joinedOn ? (profile.joinedOn | date: 'medium') : '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Created By</label>
          <span>{{ profile.createdBy || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Last Modified At</label>
          <span>{{ profile.updatedAt ? (profile.updatedAt | date: 'medium') : '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Last Modified By</label>
          <span>{{ profile.lastModifiedBy || '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Last Login At</label>
          <span>{{ profile.lastLoginAt ? (profile.lastLoginAt | date: 'medium') : '-' }}</span>
        </div>
        <div class="detail-item">
          <label>Failed Login Attempts</label>
          <span>{{ profile.failedAttempts ?? 0 }}</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Loading -->
  <ng-template #loading>
    <div class="loading-text">Loading profile...</div>
  </ng-template>
</div>